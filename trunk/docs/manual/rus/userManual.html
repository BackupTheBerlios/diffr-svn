<html>
	<head>
		<meta http-equiv="content-type" content="text/html;charset=utf-8">
		<title>Руководство пользователя</title>
		<style>
			.pname {
				color: #0233FF;
				font-family: AnjaliOldLipi;
				font-style: italic;				
			}
			body {
				background: #EEF2FF;
				margin: 1px;
				padding: 2px;
			}
			hr {
				width: 90%;
				align: center;
				border: 1px dashed #000077;
			}
			a {
				color: #775555;
			}
			.code {
				width: 69%;
				max-height: 1000px;
				overflow: auto;
				border: 1px dashed black;
				margin: 10px;
				padding: 10px;
				margin-left: 0;
				text-align: left;
				background: #CCCCFF;
			}
			pre.bc {
				font-family: AnjaliOldLipi;
				color: #001177;
			}
			pre.sc {
				font-family: AnjaliOldLipi;
				color: #001177;
				width: 70%;
				background: #CCCCFF;
				padding-top: 7px;



				border-top: none;
				border-bottom: 1px solid #AAAADD;
				border-right: none;
				margin-bottom: 1px;
			}
			pre.sr {
				font-family: AnjaliOldLipi bold;
				color: #007711;
				width: 70%;
				background: #CCFFCC;
				padding-top: 7px;
				margin-left: 5px;
				padding-left: 7px;
				}
			.cpo {
				background: #CCCCFF;
				width: 70%;
				margin-bottom: 10px;
				border-left: 8px solid #AAAADD;
			}
			.cpo div {
				margin: 0px;
				padding-left: 15px;
			}
			td {
				padding-left: 20px;
			}
			img {
				padding: 10px;
				border: 1px solid silver;
				align: center;
				margin: 20px;
			}
		</style>
	</head>
	<body>
		<h1>Diffr6</h1>
		<h2>Руководство пользователя</h2>

		<h3>Содержание</h3>
		<a href="#about">Что это такое</a><br>
		<a href="#start">Запуск программы</a><br>
		
		<a href="#window">Окно программы</a><br>
		<a href="#surface">Изменение поверхность</a><br>
		<a href="#incField">Изменение падающего поля</a><br>
		<a href="#algorithm">Выбор алгоритма</a><br>
		<a href="#run">Запуск на выполнение</a><br>
		<a href="#result">Просмотр результата</a><br>
		<a href="#newAlg">Добавление нового алгоритма</a>

		<hr>

		<a name=about></a>
		<h3>Что это такое</h3>

		<p>
			Двумерные задачи дифракции световых, электромагнитных и звуковых волн описываются хорошо известным уравнением Гельмгольца с различными дополнительными условиями на границах раздела сред и условиями на поведение поля в бесконечности.
		</p>
		<p>
			Особенностью этих задач является то, что кроме нескольких вырожденных случаев у этих задач нет аналитических решений. В настоящее время разработано большое количество численных и асимптотических методов решения этих задач. Эти методы являются разнородными, зависят от различных дополнительных параметров и предположений, «работают» только в определенном диапазоне параметров физической задачи, могут вычислять не все характеристики решения.
		</p>
		<p>
			В мире имеется большое количество исследователей и научных школ, развивающих свои методы решения двумерных задач дифракции. Однако, в силу разнородности существующих алгоритмов и программ, для решения конкретной задачи оказывается крайне сложно найти подходящий метод, по тем же причинам очень сложно сравнить различные существующие алгоритмы.
		</p>
		<p>
			Diffr6 - единая среда для моделирования двумерных задач дифракции. Рассматривается класс задач, где поверхность - гладкая, задаваемая однозначной функцией, падающая волна - плоская. В этой среде исследователи могут добавлять свои алгоритмы и моделировать при помощи них задачи дифракции.
		</p>

		<p>
			Данная среда позволит для конкретных областей значений параметров задачи дифракции определить наиболее эффективные приближенные методы. Также среда позволит сравнить  различные методы для различных классов параметров физической задачи. 
</p>

<a name=start></a>
<h3>Запуск программы</h3>
<p>
Для работы программы требуется Java 6.
Программа запускается командой<br>
<font color=blue>java –cp “bin” de.belios.diffr.Init</font><br>
(или <font color=blue>java -jar diffr.jar</font> - если она упакована в jar)<br>
</p>
<a name=rebuild></a>
<p>
Если вы используете ANT, то можно использовать команду<br>
<font color=blue>ant makejar</font><br>
для сборки проекта и<br>
<font color=blue>ant run</font><br>
для запуска.
</p>
<a name=window></a>
<h3>Окно программы</h3>

После запуска вы должны увидеть вот это:

<br>
<center><img src="../images/window.png"></center>
<br>

Справа находится изображение <dfn>поверхности</dfn> и <dfn>падающего поля</dfn>. Левая часть состоит из трёх вкладок: Input data, Result и Algorithm.
Вкладка Input data используется для изменения входных данных. Внутри неё ещё две вкладки – Surface  (Для изменения <dfn>поверхности</dfn>) и Incident field (Для изменения <dfn>падающего поля</dfn>).
Вкадка Result используется для просмотра результата вычислений. Состоит из Reflected field (Отражённое поле) и Surface current (Токи в поверхности).
Вкладка Algorithm используется для выбора алгоритма и изменения его параметров.


<a name=surface></a>
<h3>Изменение поверхности</h3>

Поверхность - гладкая, периодическая, задаётся коэффицентами Фурье.
Чтобы поменяеть её надо выбрать вкладку InputData/Surface.<br>
<p>
<table border=0>
<tr><td><font color=green><i>period</i></font></td><td> - период поверхности</td></tr>
<tr><td><font color=green><i>shift</i></font></td><td> - насколько поверхность приподнята над осью координат</td></tr>
<tr><td><font color=green><i>Number of Fourier harmonics</i></font></td><td> - количество коэффицентов Фурье</td></tr>
</table>
</p>
Далее идёт таблица коэффициентов Фурье.
<br>
Любое изменение сразу отразится на изображении поверхности справа.

<br>
<center><img src="../images/surface.png"></center>

<br>

<a name=incField></a>
<h3>Изменение падающего поля</h3>
На вкладке InputData/Incident Wave<br>
<p>
<table border=0>
<tr><td><font color=green><i>angle</i></font></td><td> - угол к вертикали (в градусах)</td></tr>
<tr><td><font color=green><i>length</i></font></td><td> - длина волны в сантиметрах (на картинке справа изображается длиной стрелочки)</td></tr>
<tr><td><font color=green><i>amplitude</i></font></td><td> - амплитуда (комплексное число)</td></tr>
<tr><td><font color=green><i>polarization</i></font></td><td> - поляризация (выбрать E или H)</td></tr>
</table>
</p>

<center><img src="../images/incidentWave.png"></center>
<br>

<a name=algorithm></a>
<h3>Выбор алгоритма</h3>
На вкладке Algorithm в верхней части есть экрана выпадающий список с названиями существующих алгоритмов<br>
Под ним - список параметров алгоритма.<br>
<a href="#newAlg">Добавление алгоритма</a>
<br>
<center><img src="../images/algorithm.png"></center>
<br>

<a name=run></a>
<h3>Запуск на выполнение</h3>
Для запуска в меню сверху выберите Task/Start или нажмите на кнопку "Start calculation"<br>

Тогда внизу экрана надпись<br>

<pre class=sr>State:
Result isn`t calculated</pre>
Заменится на<br>
<pre class=sr>State:
Task is being solved ...</pre>
А затем на<br>
<pre class=sr>State:
Result is calculated</pre>

<br>

<a name=result></a>

<h3>Просмотр результата</h3>
Результат отображается на вкладке Result.<br>
Если после вычисления результата входные данные были изменены, то результат будет изображаться серым цветом.<br>
Результат состоит из нескольких частей:<br>
Reflected Field - отраженное поле. Доступно в графическом (Graphical view) и текстовом (Text view) вариантах.

<br>
<center><img src="../images/reflectedFieldGraph.png"></center>
<br>

Красная стрелочка - падающее поле, зелёные - отражённое. Длины стрелочек пропорциональны амплитудам волн.

<br>
<center><img src="../images/reflectedFieldText.png"></center>
<br>

Surface Current - токи в поверхности. Также доступны в графическом (Graphical view) и текстовом (Text view) вариантах.

<br>
<center><img src="../images/surfaceCurrentGraph.png"></center>
<br>
<center><img src="../images/surfaceCurrentText.png"></center>
<br>

<a name=newAlg></a>
<h3>Добавление алгоритма</h3>
<p>
В Diffr6 алгоритм решения двумерных задач дифракции должен быть реализован в виде java-пакета.
Этот пакет должен быть вложен непосредственно в пакет <font class=pname>de.berlios.diffr.algorithms.addedAlgorithms</font>.
Кроме того один из его классов должен быть унаследован от класса <font class=pname>de.berlios.diffr.algorithms.Algorithm</font>
и иметь имя, совпадающее с названием пакета.
Например, алгоритм с названием MyAlgorithm должен быть реализован в классе <font class=pname>de.berlios.diffr.algorithms.addedAlgorithms.MyAlgorithm.MyAlgorithm</font>
</p>
<p>

Чтобы использовать в Diffr6 новый алгоритм, классы этого алгоритма должны быть откомпилированы
и доступны для JVM. Например можно поместить исходный код алгоритма в соответствующий каталог исходных кодов Diffr6
и <a href="#rebuild">перекомпилировать</a> проект.
</p>

<p>
Если соответствующим образом названные классы вашего алгоритма доступны для JVM, то вы можете добавить его в Diffr6
выбрав пункт меню "Algorithms/Add algorithm", и указав в появившемся окошке название алгоритмома.
</p>

<br>
<center><img src="../images/addAlgorithm.png"></center>
<br>

При написании алгоритма требуется реализовать такие методы:<br>
<div class=cpo><pre class=sc>	public String getTitle();</pre>
<div>Возвращает название, показываемое в списке для выбора алгоритма</div></div>
<div class=cpo><pre class=sc>	public String getAutor();</pre>
<div>Возвращает данные об авторе</div></div>
<div class=cpo><pre class=sc>	public String getVersion();</pre>
<div>Возвращает версию алгоритма</div></div>

<div class=cpo><pre class=sc>	public Result run(de.berlios.diffr.inputData.InputData inputData) throws Exception;</pre>
<div>Производит вычисления</div></div>

Входные данные берутся из объекта inputData.
Например:<br>
<br>

<div class=code>
<pre class=bc>
	Complex amplitude;
	IncidentWave wave;

	wave = inputData.getIncidentWave();
	amplitude = wave.getAmplitude();
</pre>
</div>


<p>
В большинстве методов решения задачи требуется предварительное обезразмеривание входных данных. Для этого предназначен класс AbstractAlgorithm. Определённый в нём метод run обезразмеривает входные данные, запускает абстрактный метод calculate, и затем проводит обратное преобразование результата.
</p>

<p>
Помимо входных данных алгоритм может получать параметры и использовать их при работе.
(Пример параметра - количество точек поверхности, в которых нужно вычислить ток.)
Для этого нужно в конструкторе иницализировать массив parameters. Каждый элемент массива содержит описание параметра и значение. При инициализации туда нужно вставить значения по умолчанию. Если пользователь поменяет параметр, то в этом массиве изменится его значение. Затем, во время работы алгоритма, из этого же массива их можно извлечь.
</p>

Пример кода:<br><br>
<div class=code>
<pre class=bc>
package de.berlios.diffr.algorithms.addedAlgorithms.MyAlgorithm;

import de.berlios.diffr.result.*;
import de.berlios.diffr.inputData.*;
import de.berlios.diffr.*;

public class MyAlgorithm extends AbstractAlgorithm {
	public MyAlgorithm(AlgorithmType algorithmType) {
		super(algorithmType);

		parameters = new DataString[1];
		parameters[0] = new DataString("description", new Double(10));
	}
	public String getTitle() {
		return "My algorithm";
	}

	public String getAutor() {
		return "My name";
	}
	public String getVersion() {
		return "1.0";
	}

	public Result calculate(InputData inputData) throws Exception {
		double parameter = (Double) parameters[0].getValue();
		...
		... Ваш код
		...
		return new Result(reflectedField, null, surfaceCurrent, energyError);

	}
}
</pre>
</div>
</body>
</html>
